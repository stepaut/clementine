{% extends "base.html" %}

{% block title %}Ежедневные данные{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Ежедневная активность</h5>
                <div id="daily-activity-chart"></div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Распределение активности</h5>
                <div id="activity-distribution-chart"></div>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Статистика</h5>
                <div id="daily-stats">
                    <p>Средняя активность: <span id="avg-activity"></span></p>
                    <p>Наиболее активные дни: <span id="peak-days"></span></p>
                    <p>Тренд активности: <span id="activity-trend"></span></p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Загрузка ежедневных данных
    fetch('/api/daily')
        .then(response => response.json())
        .then(data => {
            // График ежедневной активности
            const activityLayout = {
                title: 'Ежедневная активность',
                xaxis: { title: 'Дата' },
                yaxis: { title: 'Уровень активности' }
            };
            Plotly.newPlot('daily-activity-chart', [{
                x: data.dates,
                y: data.activity_levels,
                type: 'scatter',
                mode: 'lines+markers'
            }], activityLayout);

            // График распределения активности
            const distributionLayout = {
                title: 'Распределение активности',
                xaxis: { title: 'Уровень активности' },
                yaxis: { title: 'Количество дней' }
            };
            Plotly.newPlot('activity-distribution-chart', [{
                x: data.activity_levels,
                type: 'histogram'
            }], distributionLayout);

            // Статистика
            document.getElementById('avg-activity').textContent = data.stats.average.toFixed(2);
            document.getElementById('peak-days').textContent = data.stats.peak_days.join(', ');
            document.getElementById('activity-trend').textContent = data.stats.trend;
        });
</script>
{% endblock %} 